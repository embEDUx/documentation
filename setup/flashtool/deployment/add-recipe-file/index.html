<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">

        <title>Flashtool/Deployment/Add Recipe File - embEDUx Project</title>

        <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../../../index.html">embEDUx Project</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../../usage/usage/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/common/build-monitoring/index.html">Common/Build Monitoring</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/uboot/index.html">Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/linux/index.html">Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/rootfs/index.html">Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/rootfs/advanced/run-containers/index.html">Rootfs/Advanced/Run Containers</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/rootfs/configuration.yml/index.html">Rootfs/Configuration.Yml</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/misc/index.html">Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../../../usage/flashtool/index.html">Flashtool</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Setup <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../setup/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../repositories/index.html">Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../../adminstation/index.html">Adminstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../buildserver/index.html">Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../../buildserver/customize-buildslaves/index.html">Buildserver/Customize Buildslaves</a>
                        </li>
                    
                        <li >
                            <a href="../../../buildserver/customize-supported-platforms/index.html">Buildserver/Customize Supported Platforms</a>
                        </li>
                    
                        <li >
                            <a href="../../../post-install/toolchains/index.html">Post Install/Toolchains</a>
                        </li>
                    
                        <li >
                            <a href="../../../post-install/user-documentation/index.html">Post Install/User Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../../../workstation/index.html">Workstation</a>
                        </li>
                    
                        <li >
                            <a href="../index.html">Flashtool/Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../add-new-deployment/index.html">Flashtool/Deployment/Add New Deployment</a>
                        </li>
                    
                        <li class="active">
                            <a href="index.html">Flashtool/Deployment/Add Recipe File</a>
                        </li>
                    
                        <li >
                            <a href="../../../examples/user-documentation-DEMO/index.html">Examples/User Documentation Demo</a>
                        </li>
                    
                        <li >
                            <a href="../../../examples/user-documentation-HTWG/index.html">Examples/User Documentation Htwg</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Background <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../../background/background/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/requirements/index.html">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/index.html">Design</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/bootloader/index.html">Design/Bootloader</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/buildserver/index.html">Design/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/continuous-integration/index.html">Design/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/flashtool/index.html">Design/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/linux/index.html">Design/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/repositories/index.html">Design/Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/rootfs/index.html">Design/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/design/toolchain/index.html">Design/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/index.html">Evaluation</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/buildroot/index.html">Evaluation/Buildroot</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/buildserver-setuproutine/index.html">Evaluation/Buildserver Setuproutine</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/container-utility/index.html">Evaluation/Container Utility</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/continuous-integration/index.html">Evaluation/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/flashtool/index.html">Evaluation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/linux/index.html">Evaluation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/rootfs/index.html">Evaluation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/toolchain/index.html">Evaluation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/uboot/index.html">Evaluation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/evaluation/yocto-project/index.html">Evaluation/Yocto Project</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/index.html">Implementation</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/buildserver/index.html">Implementation/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/flashtool/index.html">Implementation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/flashtool/code-documentation/index.html">Implementation/Flashtool/Code Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/linux/index.html">Implementation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/misc/index.html">Implementation/Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/repositories-and-branches/index.html">Implementation/Repositories And Branches</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/rootfs/index.html">Implementation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/toolchain/index.html">Implementation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/implementation/uboot/index.html">Implementation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/summary/index.html">Summary</a>
                        </li>
                    
                        <li >
                            <a href="../../../../background/terminology/index.html">Terminology</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Troubleshooting <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../../troubleshooting/troubleshooting/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../../troubleshooting/entering-build-environment/index.html">Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../../troubleshooting/faq/index.html">Faq</a>
                        </li>
                    
                        <li >
                            <a href="../../../../troubleshooting/local-testing/index.html">Local Testing</a>
                        </li>
                    
                        <li >
                            <a href="../../../../troubleshooting/rootfs/entering-build-environment/index.html">Rootfs/Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../../troubleshooting/rootfs/monitoring-package-installation/index.html">Rootfs/Monitoring Package Installation</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../../support/contact-team/index.html">Contact Team</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../add-new-deployment/index.html">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../../examples/user-documentation-DEMO/index.html">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#recipe-files">Recipe files</a></li>
        
            <li><a href="#recipe-files-name-scheme">Recipe files Name-Scheme</a></li>
        
            <li><a href="#recipe-skeletons">Recipe Skeletons</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="recipe-files">Recipe files</h1>
<p>This chapter explains how to write a new recipe file for a platform. If you do
not know what a recipe file is and which role it plays in the deployment
procedure, please read the chapter <a href="../index.html">Deployment with the Flashtool</a> 
first.</p>
<h2 id="recipe-files-name-scheme">Recipe files Name-Scheme</h2>
<p>The name of a <strong>recipe</strong> file must follow this naming scheme:</p>
<p>{hardware-name}_{identifier}.yml</p>
<p><strong>The name and identifier must not contain underscores, please use dashes instead.</strong></p>
<p>The <em>underscore</em> is used to divide the recipe file name in the two parts 
<em>platform name</em> and <em>identifier</em>. It is important that the platform name is also 
registered on the buildserver. You will find the valid platform-strings for
your <strong>embEDUx</strong> system in the <a href="../../../post-install/user-documentation/index.html">User Documentation</a>.</p>
<p>The next example shows how to use this name scheme for a Raspberry Pi. This
name scheme is also used in the 
<a href="../../../examples/user-documentation-HTWG/index.html#platform-strings">HTWG setup</a> of <strong>embEDUx</strong>.</p>
<blockquote>
<p>raspberry-pi.yml</p>
<p>raspberry-pi_media-center.yml</p>
</blockquote>
<p>The name for a Raspberry Pi in this <strong>embEDUx</strong> configuration is <em>"raspberry-pi"</em>.
This name will be used in branches of the <strong>git repositories</strong> and on the
<strong>buildbot</strong> server to identify a Raspberry Pi.</p>
<h2 id="recipe-skeletons">Recipe Skeletons</h2>
<p>For the extensibility of the <strong>Flashtool</strong>, it provides the possibility to
define different recipe skeletons. Each skeleton must have its counterpart
implemented in the python code of the <strong>Flashtool</strong>. By now we support the <em>mmc</em>
recipe skeleton which is used in every recipe file on the <strong>embEDUx</strong>
<a href="https://github.com/embEDUx/flashtool-recipes">repository</a>.  </p>
<p>The recipe skeleton <em>mmc</em> can handle the most deployment procedures for a wide
range of embedded hardware. If you need to implement a new recipe skeleton, please
read the section <a href="../add-new-deployment/index.html">How to add a new deployment</a>.</p>
<h3 id="mmc">MMC:</h3>
<p>This recipe skeleton is used to configure platforms which use a <em>MMC</em> device as
storage media. The template below shows, how to state this recipe skeleton in a 
recipe file.</p>
<pre><code class="yaml">---

type: mmc

recipe:
    partition_table: #partition table type
    partitions: # list with partition information
        -   name: # label
            size: # size of partition (allowed %/b/kb/mb/gb/)
            fs_type: # filesystem type (e.g. fat32, ext4)
            mount_point: # Mount point in System
            mount_opts:  # Mount options
            flags: # flags for partition
        -   #...
    load:
        Uboot:
            # device: or command:
        Linux_Boot:
            # device: or command:
        Linux_Root:
            # device: or command:
        Linux_Config:
            # device: or command:
        Rootfs:
            # device: or command:
        Misc_Boot:
            # device: or command:
        Misc_Root:
            # device: or command:
</code></pre>

<ul>
<li>
<p><strong><em>partition_table</em></strong>:</p>
<p>This section defines the partition table of the mmc device. The most embedded
  devices use <em>msods</em> or <em>gpt</em> for the partition table.</p>
</li>
<li>
<p><strong><em>partitions</em></strong>:</p>
<p>This section is used to define partitions on the mmc device. Each partition
  must be listed with a dash and must contain the subsections name, size,
  fs_type, mount_point, mount_opts and flags. If one of these section is not
  needed, just leave the value after the colon blank.</p>
<ul>
<li>
<p><strong><em>name</em></strong>:</p>
<p>Name or label of the partition. The partition table type must support this
feature.</p>
</li>
<li>
<p><strong><em>size</em></strong>:</p>
<p>Size of the partition. The used units are b (byte), kb (kilobyte), mb
(megabyte), gb (gigabyte) and %. It is also possible to use the keyword
<em>max</em> for the last stated partition. If you want to state the size of the
partion in percentage, please use the percentage notation for each
partition.</p>
</li>
<li>
<p><strong><em>fs_type</em></strong>:</p>
<p>Filesystem type of the system. The <strong>Flashtool</strong> supports ext2, ext3, ext4,
fat32 and btrfs.</p>
</li>
<li>
<p><strong><em>mount_point</em></strong>:</p>
<p>Specifies the mount point which will be written in the <strong>fstab</strong> of the linux
system.</p>
</li>
<li>
<p><strong><em>mount_opts</em></strong>:</p>
<p>Specifies the mount options for the partition which will be written in the
<strong>fstab</strong> of the linux system.</p>
</li>
<li>
<p><strong><em>flags</em></strong>:</p>
<p>Flag for the partition. e.g. <em>boot</em>, <em>lba</em>. Multiple flags must be seperated 
with a comma.</p>
</li>
</ul>
</li>
<li>
<p><strong><em>load</em></strong>:</p>
<p>This section defines on which partition a software product should be loaded.
  The user can choose between the option <em>device</em> or <em>command</em> for every
  subsection. If a software product should be loaded on a partition of the mmc
  device, the user must use the option <em>device</em> and state the index of the
  partition which is defined in the section <strong>partitions</strong>. The index starts
  with zero.</p>
<p>If a product should be loaded with an external command to the mmc device, you
  must use the option <strong>command</strong>. The value of the option is the external
  command. For a command you can use the to template variables <em>${file}</em> and
  <em>${device}</em>. The variable <em>${file}</em> will be replaced with the name of the
  specific software product. The variable <em>${device}</em> will be replaced with the
  <em>/dev path</em> of the mmc device or the <em>dev path</em> of the mmc partition, if a
  number is written at the end of the variable (e.g. <em>${device0}</em>).</p>
<p>The existing software products are Uboot, Linux_Boot, Linux_Root,
  Linux_Config, Rootfs, Misc_Boot, Misc_Root.</p>
</li>
</ul>
<p><strong>Example for a recipe file with a mmc recipe (utilite-pro.yml):</strong> - Also available in
the HTWG configuration.</p>
<pre><code>---
type: mmc

recipe:
    partition_table: msdos
    partitions:
        -   name: boot
            size: 100mb
            fs_type: fat32
            mount_point: /boot
            mount_opts:
            flags: lba
        -   name: rootfs
            size: max
            fs_type: btrfs
            mount_point: /
            mount_opts:
            flags: 
    load:
        Uboot:
            command: dd if=${file} of=${device} bs=1K skip=1 seek=1 oflag=dsync
        Linux_Boot:
            device: 0
        Linux_Root:
            device: 1
        Linux_Config:
            device: 1
        Rootfs:
            device: 1
</code></pre>

</div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../../js/prettify-1.0.min.js"></script>
        <script src="../../../../js/base.js"></script>
    </body>
</html>