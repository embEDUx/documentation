<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Evaluation/Buildserver Setuproutine - embEDUx Project</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../../index.html">embEDUx Project</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../usage/usage/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/common/build-monitoring/index.html">Common/Build Monitoring</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/uboot/index.html">Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/linux/index.html">Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/index.html">Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/advanced/run-containers/index.html">Rootfs/Advanced/Run Containers</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/configuration.yml/index.html">Rootfs/Configuration.Yml</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/misc/index.html">Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/flashtool/index.html">Flashtool</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Setup <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../setup/setup/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/repositories/index.html">Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/adminstation/index.html">Adminstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/index.html">Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/customize-buildslaves/index.html">Buildserver/Customize Buildslaves</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/customize-supported-platforms/index.html">Buildserver/Customize Supported Platforms</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/toolchains/index.html">Post Install/Toolchains</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/user-documentation/index.html">Post Install/User Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/workstation/index.html">Workstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/index.html">Flashtool/Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/add-new-deployment/index.html">Flashtool/Deployment/Add New Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/add-recipe-file/index.html">Flashtool/Deployment/Add Recipe File</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/examples/user-documentation-DEMO/index.html">Examples/User Documentation Demo</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/examples/user-documentation-HTWG/index.html">Examples/User Documentation Htwg</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Background <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../background/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../requirements/index.html">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../../design/index.html">Design</a>
                        </li>
                    
                        <li >
                            <a href="../../design/bootloader/index.html">Design/Bootloader</a>
                        </li>
                    
                        <li >
                            <a href="../../design/buildserver/index.html">Design/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../design/continuous-integration/index.html">Design/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../../design/flashtool/index.html">Design/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../design/linux/index.html">Design/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../design/repositories/index.html">Design/Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../design/rootfs/index.html">Design/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../design/toolchain/index.html">Design/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../index.html">Evaluation</a>
                        </li>
                    
                        <li >
                            <a href="../buildroot/index.html">Evaluation/Buildroot</a>
                        </li>
                    
                        <li class="active">
                            <a href="index.html">Evaluation/Buildserver Setuproutine</a>
                        </li>
                    
                        <li >
                            <a href="../container-utility/index.html">Evaluation/Container Utility</a>
                        </li>
                    
                        <li >
                            <a href="../continuous-integration/index.html">Evaluation/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../flashtool/index.html">Evaluation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../linux/index.html">Evaluation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../rootfs/index.html">Evaluation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../toolchain/index.html">Evaluation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../uboot/index.html">Evaluation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../yocto-project/index.html">Evaluation/Yocto Project</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/index.html">Implementation</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/buildserver/index.html">Implementation/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/flashtool/index.html">Implementation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/linux/index.html">Implementation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/misc/index.html">Implementation/Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/repositories-and-branches/index.html">Implementation/Repositories And Branches</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/rootfs/index.html">Implementation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/toolchain/index.html">Implementation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/uboot/index.html">Implementation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../terminology/index.html">Terminology</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Troubleshooting <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../troubleshooting/troubleshooting/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/entering-build-environment/index.html">Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/faq/index.html">Faq</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/local-testing/index.html">Local Testing</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/rootfs/entering-build-environment/index.html">Rootfs/Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/rootfs/monitoring-package-installation/index.html">Rootfs/Monitoring Package Installation</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../support/contact-team/index.html">Contact Team</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../buildroot/index.html">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../container-utility/index.html">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#buildserver-setup-routine-evaluation">Buildserver Setup routine Evaluation</a></li>
        
            <li><a href="#python">Python</a></li>
        
            <li><a href="#ansible">Ansible</a></li>
        
            <li><a href="#setup-steps-evaluation">Setup Steps Evaluation</a></li>
        
            <li><a href="#result-buildserver-setup-routine-evaluation">Result Buildserver Setup routine Evaluation</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="buildserver-setup-routine-evaluation">Buildserver Setup routine Evaluation</h1>
<p>The buildserver design describes the <a href="../../design/buildserver/index.html#setup-automation-routine">setup automation
routine</a>. It is designed to
install and initialize the different components of the <strong>embEDUx</strong> buildserver
on the buildserver target machine.</p>
<p>The two candidates for the implementation are Python and Ansible. In order to
chose the right one, the functionality needs to be compared to the
design specifications and previous evaluation results.</p>
<h2 id="python">Python</h2>
<p>Python is a general purpose scripting language that offers a wide variety of standard and
additional modules. In theory, there should be no limitation to the complexity
of the setup process when Python is used. It is assumed that Python is already
known to the reader.</p>
<h2 id="ansible">Ansible</h2>
<p>Ansible is an administration utility written in Python, with a focus on
automation of predefined actions. The actions that are available correspond to
modules, and can be customized according to the available module parameters.
Standard modules include things like installing packages, enabling system
services, manage user accounts, synchronize files to or from the target
machines, and many more. Ansible can be extended with custom modules, but the
builtin modules already provide great functionality. The connection to the
target machine uses SSH. </p>
<h3 id="quick-introduction">Quick Introduction</h3>
<p>Ansible actions are organized and configured with different entities.  All
entities are defined in separate files, which are specified in the <strong>YAML</strong>
language.</p>
<h4 id="hosts">Hosts</h4>
<p>The first entity that needs to be defined is the hosts inventory. The hosts
inventory contains the address, SSH username and other host specific
information.</p>
<ul>
<li>Hosts</li>
<li>Groups, can consist of several hosts</li>
</ul>
<h4 id="tasks">Tasks</h4>
<p>Tasks use modules and module parameters to define actions that can be run on
target hosts. Tasks can be reused and grouped into several other entities.</p>
<ul>
<li>Tasks</li>
<li>Roles, can consist of several tasks</li>
<li>Plays, can include several roles</li>
<li>Playbooks, can consist of several plays</li>
</ul>
<h4 id="variables">Variables</h4>
<p>Variable files can be specified to each element of the previous two entity
groups. There's also a special variable file that, unless overriden,  is valid
for all hosts at all times.</p>
<h2 id="setup-steps-evaluation">Setup Steps Evaluation</h2>
<h3 id="executing-commands-on-the-target-machine">Executing commands on the target machine</h3>
<ul>
<li>
<p>SSH</p>
</li>
<li>
<p>Python</p>
<p>Several modules are available, but none seems to make use of an already
running SSH-agent.</p>
</li>
<li>
<p>Ansible</p>
<p>Ansible is based on SSH connections, and uses it as the default method for
connecting to the target machine. It makes use of already running
SSH-agents.</p>
</li>
</ul>
<h3 id="configuration-templates">Configuration Templates</h3>
<p>As specified under <a href="../../design/buildserver/index.html#required-setup-parameters">configuration generation in the buildserver
design</a>, template generation
is required during the buildserver setup.</p>
<ul>
<li>
<p>Python</p>
<p>Several python modules offer template rendering. Among them is the Jinja2
templating engine which is a suitable candidate.</p>
</li>
<li>
<p>Ansible</p>
<p>A module for Jinja2 template rendering is included with the default Ansible
setup. It can be used for rendering templates to local or remote destination
paths. Defined ansible variables will be used to replace
template variables.</p>
</li>
</ul>
<h3 id="package-installation">Package Installation</h3>
<p><strong>Docker</strong> is the only non-default package that needs to be installed on the
remote host. </p>
<ul>
<li>apt</li>
<li>portage</li>
</ul>
<h3 id="docker-container-management">Docker Container Management</h3>
<p>By the time of the design phase, it hasn't been clear yet which container
utility will be used to implement the abstraction. The <a href="../container-utility/index.html">container utility
evaluation</a> has chosen <strong>Docker</strong>. The necessary steps for
setting up the container infrastructure during the setup can now be listed, in
order to find the right tool for the setup routine.</p>
<p>As specified in the <a href="../rootfs/index.html#conclusion">RootFS
evaluation</a>, the RootFS build routine needs Gentoo portage.
Therefore, the Docker images for the buildserver components will be based on
stage3 archives too.</p>
<ul>
<li>Download Gentoo stage3 archives for<ul>
<li>buildmaster - native machine architecture</li>
<li>buildslaves - one per target architecture</li>
</ul>
</li>
<li>Build buildmaster container with the following packages<ul>
<li>buildbot master component</li>
</ul>
</li>
<li>Build containers for the the buildslave component.<ul>
<li>Default buildslaves containers. Build environment for <ul>
<li>Native and Cross-Target U-Boot, Linux, Misc, Toolchain</li>
</ul>
</li>
<li>RootFS Buildslaves containers. Build environment for<ul>
<li>Native- and Cross-Target RootFS</li>
</ul>
</li>
</ul>
</li>
<li>Start Containers</li>
</ul>
<h3 id="result-buildserver-setup-routine-steps-evaluation">Result Buildserver Setup routine Steps Evaluation</h3>
<table>
<thead>
<tr>
<th>Setup steps</th>
<th>Python</th>
<th>Ansible</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSH</td>
<td>Difficult / manual key management</td>
<td>native method / uses SSH-agent</td>
</tr>
<tr>
<td>Template Rendering</td>
<td>addon jinja2 module / manual file handling</td>
<td>native jinja2 template module / easy</td>
</tr>
<tr>
<td>Package Installation</td>
<td>command module manual SSH commands</td>
<td>native apt module / easy</td>
</tr>
<tr>
<td>Docker Container Management</td>
<td>addon docker-py module / manual API calls</td>
<td>native docker module / easy</td>
</tr>
</tbody>
</table>
<h2 id="result-buildserver-setup-routine-evaluation">Result Buildserver Setup routine Evaluation</h2>
<p>The original criteria can now be analyzed according to the results of the steps
evaluation.</p>
<table>
<thead>
<tr>
<th>Eval criteria</th>
<th>Python</th>
<th>Ansible</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ready-for-use components availability</td>
<td>ok</td>
<td>ok</td>
</tr>
<tr>
<td>Extensibility effort</td>
<td>medium</td>
<td>easy</td>
</tr>
<tr>
<td>Templating features</td>
<td>uncomfortable</td>
<td>comfortable</td>
</tr>
<tr>
<td>Code readability</td>
<td>good</td>
<td>very good</td>
</tr>
</tbody>
</table>
<p>Even though Python is a scripting programming language with many modules
available, <strong>Ansible</strong> is better for the purpose of automating the given tasks.
It has builtin modules for all of the required tasks which should allow for an
efficient implementation.</p>
</div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/prettify-1.0.min.js"></script>
        <script src="../../../js/base.js"></script>
    </body>
</html>