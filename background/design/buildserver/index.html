<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Design/Buildserver - embEDUx Project</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../../index.html">embEDUx Project</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../usage/usage/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/common/build-monitoring/index.html">Common/Build Monitoring</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/uboot/index.html">Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/linux/index.html">Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/index.html">Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/advanced/run-containers/index.html">Rootfs/Advanced/Run Containers</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/configuration.yml/index.html">Rootfs/Configuration.Yml</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/misc/index.html">Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/flashtool/index.html">Flashtool</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Setup <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../setup/setup/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/repositories/index.html">Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/adminstation/index.html">Adminstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/index.html">Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/customize-buildslaves/index.html">Buildserver/Customize Buildslaves</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/customize-supported-platforms/index.html">Buildserver/Customize Supported Platforms</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/build-qemu-kernels/index.html">Post Install/Build Qemu Kernels</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/toolchains/index.html">Post Install/Toolchains</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/user-documentation/index.html">Post Install/User Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/workstation/index.html">Workstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/index.html">Flashtool/Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/add-new-deployment/index.html">Flashtool/Deployment/Add New Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/add-recipe-file/index.html">Flashtool/Deployment/Add Recipe File</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/examples/user-documentation-DEMO/index.html">Examples/User Documentation Demo</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/examples/user-documentation-HTWG/index.html">Examples/User Documentation Htwg</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Background <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../background/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../requirements/index.html">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../index.html">Design</a>
                        </li>
                    
                        <li >
                            <a href="../bootloader/index.html">Design/Bootloader</a>
                        </li>
                    
                        <li class="active">
                            <a href="index.html">Design/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../continuous-integration/index.html">Design/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../flashtool/index.html">Design/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../linux/index.html">Design/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../repositories/index.html">Design/Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../rootfs/index.html">Design/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../toolchain/index.html">Design/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/index.html">Evaluation</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/buildroot/index.html">Evaluation/Buildroot</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/buildserver-setuproutine/index.html">Evaluation/Buildserver Setuproutine</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/container-utility/index.html">Evaluation/Container Utility</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/continuous-integration/index.html">Evaluation/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/flashtool/index.html">Evaluation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/linux/index.html">Evaluation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/rootfs/index.html">Evaluation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/toolchain/index.html">Evaluation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/uboot/index.html">Evaluation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/yocto-project/index.html">Evaluation/Yocto Project</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/index.html">Implementation</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/buildserver/index.html">Implementation/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/flashtool/index.html">Implementation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/flashtool/code-documentation/index.html">Implementation/Flashtool/Code Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/linux/index.html">Implementation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/misc/index.html">Implementation/Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/repositories-and-branches/index.html">Implementation/Repositories And Branches</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/rootfs/index.html">Implementation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/toolchain/index.html">Implementation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../implementation/uboot/index.html">Implementation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../summary/index.html">Summary</a>
                        </li>
                    
                        <li >
                            <a href="../../terminology/index.html">Terminology</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Troubleshooting <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../troubleshooting/troubleshooting/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/entering-build-environment/index.html">Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/faq/index.html">Faq</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/local-testing/index.html">Local Testing</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/rootfs/entering-build-environment/index.html">Rootfs/Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/rootfs/monitoring-package-installation/index.html">Rootfs/Monitoring Package Installation</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../support/contact-team/index.html">Contact Team</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../bootloader/index.html">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../continuous-integration/index.html">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#buildserver">Buildserver</a></li>
        
            <li><a href="#automated-build-triggering">Automated Build Triggering</a></li>
        
            <li><a href="#platform-support-extensibility">Platform Support Extensibility</a></li>
        
            <li><a href="#setup-automation-routine">Setup Automation Routine</a></li>
        
            <li><a href="#abstraction-layer-for-automation">Abstraction Layer For Automation</a></li>
        
            <li><a href="#linux-containers-utility-candidates">Linux-Containers Utility Candidates</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="buildserver">Buildserver</h1>
<p>This chapter describes the design of the buildserver components and the setup
routine which is used to install these components on the buildserver machine.</p>
<h2 id="automated-build-triggering">Automated Build Triggering</h2>
<p>The builds for the different products should be triggered in an automated manner
as soon as the build specifications are updated by the user. As the build
specifications are stored inside the product repositories, the buildserver needs
to watch them for changes and trigger a new build on detected changes. The
builds should only be triggered for the products that received new build
specifications in their repositories.</p>
<h3 id="main-tasks">Main Tasks</h3>
<ul>
<li>Watch product repositories for changes</li>
<li>Start build process for detected change</li>
</ul>
<h3 id="additional-tasks-and-features">Additional Tasks and Features</h3>
<ol>
<li>Split functionality<ul>
<li>Repository Observer, Build Scheduler</li>
<li>Build Executor</li>
</ul>
</li>
<li>Provide an overview of recent and running builds</li>
<li>View Log-files or recent and running builds</li>
<li>Allow to manually manage build jobs<ul>
<li>(Re-)schedule builds</li>
<li>Cancel builds</li>
</ul>
</li>
<li>Flexible build job specifications</li>
</ol>
<p>All of the above matches exactly to what is generally referred as <em>continuous
integration</em>, which will be further discussed in the <a href="../continuous-integration/index.html">Continuous Integration
Design Chapter</a>.</p>
<h2 id="platform-support-extensibility">Platform Support Extensibility</h2>
<p>Adding support for additional hardware platforms must be simple. The user should
not be forced to have a complete understanding of the <strong>embEDUx</strong> build system
to be able to add his platform. One way to look at extensibility is to already
take the initial setup into account. At this point, adding a new platform should
be no different than adding a new platform later. Designing this step to be as
easy as possible will be beneficial to the initial setup and to the
extensibility at the same time. Therefore, this criteria is moved over to the
<a href="#setup-automation-routine">setup automation routine design</a>, which is the next
chapter.</p>
<h2 id="setup-automation-routine">Setup Automation Routine</h2>
<p>The job of the setup routine is to setup all buildserver components. The
buildserver will undoubtedly be a complex structure of software components. To
make the setup as easy as possible it should be automated as far as possible.</p>
<h3 id="required-setup-parameters">Required Setup Parameters</h3>
<p>The administrator should only have to configure the parameters that can't
possibly be known upfront, or are not convenient to be predefined. At this
point, these parameters include</p>
<ul>
<li>
<p>Buildserver Machine Address</p>
<p>The target machine shall by default run all containers that belong to the
buildsystem</p>
</li>
<li>
<p>Authentication credentials between system components</p>
<p>While this could in general be generated randomly, it is chosen to let the
user set the credentials for system internal communication.</p>
</li>
<li>
<p>Authentication credentials between the system components and the users</p>
<p>Default usernames and passwords are possible security holes, and should not
be provided by the setup routine.</p>
</li>
</ul>
<h3 id="optional-setup-parameters">Optional Setup Parameters</h3>
<p>These setup parameters are likely to be adjusted by the administrator, but
should be shipped with defaults from the HTWG setup.</p>
<ul>
<li>
<p>Target Platform and Architectures</p>
<p>The platform names and their corresponding architecture. The architectures
will be supported as build targets. By default, all tested platforms will be
available as supported. The user is not forced to use them, but it is useful
to already have working examples in the local installation.</p>
</li>
</ul>
<h3 id="default-setup-parameters">Default Setup Parameters</h3>
<p>All other setup parameters should be provided as defaults by the setup routine.</p>
<h3 id="configuration-generation-from-templates">Configuration Generation From Templates</h3>
<p>The configured and default setup parameters should be used to generate the
configuration files for the buildsystem. For commonly used changes, the
generator can be extended and can be utilized by beginners immediately.
Advanced users will still be able to modify the template if necessary. </p>
<h3 id="setup-automation-routine-candidates">Setup Automation Routine Candidates</h3>
<p>The setup routine should be automated using an appropriate programming or
scripting language. The chosen language needs to be flexible in detecting
conditions, since every setup run will have different conditions.
The candidates are</p>
<ul>
<li>Python</li>
<li>Ansible</li>
</ul>
<h4 id="evaluation-criteria">Evaluation Criteria</h4>
<p>The criteria that will be evaluated are</p>
<ul>
<li>Ready-for-use components availability</li>
<li>Extensibility effort</li>
<li>Templating features</li>
<li>Code readability</li>
</ul>
<h3 id="setup-automation-routine-tasks">Setup Automation Routine Tasks</h3>
<p>The following tasks need to be done by the setup routine.</p>
<h4 id="execute-commands-on-the-target-machine">Execute commands on the target machine</h4>
<p>Executing commands on the target machine will be necessary in order to complete
the setup. The most commonly remote control utility is <strong>SSH</strong>, which shall be
used for the setup routine too, without any further evaluation.</p>
<h4 id="package-installation">Package Installation</h4>
<p>The build environment requires all the necessary tools to be installed on the
buildserver. It is assumed that the buildserver runs a Linux distribution that
has a package manager available. As it has not been mentioned in any previous
steps, it is necessary to chose the supported package managers now. A sane
decision is to support <strong>Ubuntu</strong> and <strong>Gentoo</strong> as buildserver machines, and
therefore to support <strong>apt</strong> and <strong>portage</strong>.</p>
<h2 id="abstraction-layer-for-automation">Abstraction Layer For Automation</h2>
<p>In order to have an automated build system, all components should be setup and
run abstracted from the buildserver's host system as far as possible.
Abstraction methods make it possible to deploy and run complex infrastructures
without having to care about the underlying hardware and system configuration.</p>
<p>Possible technologies for abstracting applications and whole operating systems
include Virtual Machines and Linux Containers.</p>
<h3 id="virtual-machines">Virtual Machines</h3>
<p>Virtual Machines are completely abstracted from the host system's hardware.
They run on a so-called Hypervisor, which simulates a complete machine for the
target system. The target system runs it's own kernel, and needs to boot and
initialize an Operating System from scratch. Security is considered very high,
since the Hypervisor has full control over soft- and hardware-resources that are
passed to the guest system. The architecture of an operating system inside a
virtual machine can be completely different to the host architecture, and thus
is highly portable. Depending on available acceleration technologies, the
performance of the virtual CPU, RAM and disk can suffer significantly.</p>
<h3 id="linux-containers">Linux Containers</h3>
<p>Linux Containers utilize a feature in recent Linux Kernels which allow
separating processes from each other. This includes the separation of host and
contained processes, as well as different contained processes from each other.
These contained processes can be an initialization processes to boot a different
Linux System on the running host Linux kernel, or simply any other application
available. Recently there has been a lot of development and activity on Linux
Containers in the community, namely because of a software called Docker.
Security is highly dependent on the implementation of the process separating
that happens in the host kernel. The host kernel must obviously be able to run
the contained application. Therefore, the application must either be in the
host's native or compatible executable format, or the system needs an emulator
to run the foreign architecture. The performance for contained processes does
not differ significantly compared to a regular running process. This is not
entirely true for executables that require emulation because the CPU
instructions must be translated before they can be run.</p>
<h3 id="choosing-linux-containers">Choosing Linux-Containers</h3>
<p>In favor of speed (see <a href="http://domino.research.ibm.com/library/cyberdig.nsf/papers/0929052195DD819C85257D2300681E7B/$File/rc25482.pdf">Comparison of VM and Linux
Containers</a>)
container technologies should be chosen as the base for the buildsystem
components. In environments where security is a high requirement, the containers
can live inside a virtual machine, but that is beyond the design for the
buildsystem itself.</p>
<h3 id="splitting-functionality-into-containers">Splitting Functionality Into Containers</h3>
<p>Performance wise, containers are relatively cheap entities for the system. This
allows the buildsystem to be split into several containers for the different
parts of the buildsystem, without losing performance over a flat installation on
the system. The container infrastructure could split the different components of
the continuous integration system into containers.</p>
<ul>
<li>
<p>One Buildmaster</p>
<p>Running with native buildserver host architecture, and has the following
responsibilities</p>
<ul>
<li>Watch all the product repositories for changes</li>
<li>Delegate build processes to buildslaves on changes</li>
</ul>
</li>
<li>
<p>Buildslaves with target architecture specific build tools</p>
<p>Runs emulated or natively with the target architecture, and has the
following target archtecture specific components:</p>
<ul>
<li>Toolchain</li>
<li>Compiler flags</li>
<li>Base system archive</li>
</ul>
</li>
</ul>
<h4 id="container-management-setup-steps">Container Management Setup Steps</h4>
<p>Managing containers includes more than starting and stopping them. The setup
routine needs to assemble the content from scratch. This requires an image which
the container setup process will be based on. The container management includes
roughly the following steps. They will be specified in more detail in the
evaluation step, when the container utility has been chosen.</p>
<ul>
<li>Prepare Container Images</li>
<li>Build Containers according to Buildjob specifications</li>
</ul>
<h2 id="linux-containers-utility-candidates">Linux-Containers Utility Candidates</h2>
<p>There is still the choice to make which utility should be used in order to
utilize the Linux-Containers functionality.</p>
<ul>
<li><strong>Docker</strong></li>
<li><strong>LXC</strong></li>
<li><strong>OpenVZ</strong></li>
</ul>
<p>The chapter <a href="../../evaluation/container-utility/index.html">Container Utility Evaluation</a>
shows the investigation of the candidates.</p>
</div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/prettify-1.0.min.js"></script>
        <script src="../../../js/base.js"></script>
    </body>
</html>