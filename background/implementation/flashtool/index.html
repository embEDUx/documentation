<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Implementation/Flashtool - embEDUx Project</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../../index.html">embEDUx Project</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../usage/usage/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/common/build-monitoring/index.html">Common/Build Monitoring</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/uboot/index.html">Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/linux/index.html">Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/index.html">Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/advanced/run-containers/index.html">Rootfs/Advanced/Run Containers</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/rootfs/configuration.yml/index.html">Rootfs/Configuration.Yml</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/misc/index.html">Misc</a>
                        </li>
                    
                        <li >
                            <a href="../../../usage/flashtool/index.html">Flashtool</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Setup <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../setup/setup/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/repositories/index.html">Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/adminstation/index.html">Adminstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/index.html">Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/customize-buildslaves/index.html">Buildserver/Customize Buildslaves</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/buildserver/customize-supported-platforms/index.html">Buildserver/Customize Supported Platforms</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/build-qemu-kernels/index.html">Post Install/Build Qemu Kernels</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/toolchains/index.html">Post Install/Toolchains</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/post-install/user-documentation/index.html">Post Install/User Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/workstation/index.html">Workstation</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/index.html">Flashtool/Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/add-new-deployment/index.html">Flashtool/Deployment/Add New Deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/flashtool/deployment/add-recipe-file/index.html">Flashtool/Deployment/Add Recipe File</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/examples/user-documentation-DEMO/index.html">Examples/User Documentation Demo</a>
                        </li>
                    
                        <li >
                            <a href="../../../setup/examples/user-documentation-HTWG/index.html">Examples/User Documentation Htwg</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Background <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../background/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../requirements/index.html">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../../design/index.html">Design</a>
                        </li>
                    
                        <li >
                            <a href="../../design/bootloader/index.html">Design/Bootloader</a>
                        </li>
                    
                        <li >
                            <a href="../../design/buildserver/index.html">Design/Buildserver</a>
                        </li>
                    
                        <li >
                            <a href="../../design/continuous-integration/index.html">Design/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../../design/flashtool/index.html">Design/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../design/linux/index.html">Design/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../design/repositories/index.html">Design/Repositories</a>
                        </li>
                    
                        <li >
                            <a href="../../design/rootfs/index.html">Design/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../design/toolchain/index.html">Design/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/index.html">Evaluation</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/buildroot/index.html">Evaluation/Buildroot</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/buildserver-setuproutine/index.html">Evaluation/Buildserver Setuproutine</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/container-utility/index.html">Evaluation/Container Utility</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/continuous-integration/index.html">Evaluation/Continuous Integration</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/flashtool/index.html">Evaluation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/linux/index.html">Evaluation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/rootfs/index.html">Evaluation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/toolchain/index.html">Evaluation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/uboot/index.html">Evaluation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../evaluation/yocto-project/index.html">Evaluation/Yocto Project</a>
                        </li>
                    
                        <li >
                            <a href="../index.html">Implementation</a>
                        </li>
                    
                        <li >
                            <a href="../buildserver/index.html">Implementation/Buildserver</a>
                        </li>
                    
                        <li class="active">
                            <a href="index.html">Implementation/Flashtool</a>
                        </li>
                    
                        <li >
                            <a href="code-documentation/index.html">Implementation/Flashtool/Code Documentation</a>
                        </li>
                    
                        <li >
                            <a href="../linux/index.html">Implementation/Linux</a>
                        </li>
                    
                        <li >
                            <a href="../misc/index.html">Implementation/Misc</a>
                        </li>
                    
                        <li >
                            <a href="../repositories-and-branches/index.html">Implementation/Repositories And Branches</a>
                        </li>
                    
                        <li >
                            <a href="../rootfs/index.html">Implementation/Rootfs</a>
                        </li>
                    
                        <li >
                            <a href="../toolchain/index.html">Implementation/Toolchain</a>
                        </li>
                    
                        <li >
                            <a href="../uboot/index.html">Implementation/Uboot</a>
                        </li>
                    
                        <li >
                            <a href="../../summary/index.html">Summary</a>
                        </li>
                    
                        <li >
                            <a href="../../terminology/index.html">Terminology</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Troubleshooting <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../troubleshooting/troubleshooting/index.html">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/entering-build-environment/index.html">Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/faq/index.html">Faq</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/local-testing/index.html">Local Testing</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/rootfs/entering-build-environment/index.html">Rootfs/Entering Build Environment</a>
                        </li>
                    
                        <li >
                            <a href="../../../troubleshooting/rootfs/monitoring-package-installation/index.html">Rootfs/Monitoring Package Installation</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../../support/contact-team/index.html">Contact Team</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../buildserver/index.html">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="code-documentation/index.html">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#flashtool-implementation">Flashtool Implementation</a></li>
        
            <li><a href="#overview">Overview</a></li>
        
            <li><a href="#configuration-file-and-working-directory">Configuration File And Working Directory</a></li>
        
            <li><a href="#recipe-file-for-platforms">Recipe File For Platforms</a></li>
        
            <li><a href="#retrieving-software-products">Retrieving software products</a></li>
        
            <li><a href="#recognizing-mmc-devices">Recognizing MMC devices</a></li>
        
            <li><a href="#deployment-of-products-to-the-mmc-device">Deployment Of Products To The MMC Device</a></li>
        
            <li><a href="#generating-fstab">Generating fstab</a></li>
        
            <li><a href="#list-of-features">List of features</a></li>
        
            <li><a href="#directory-structure-of-the-flashtool">Directory structure of the Flashtool</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="flashtool-implementation">Flashtool Implementation</h1>
<p>This describes the implementation of the <strong>Flashtool</strong> that has been worked 
out according to the <a href="../../design/flashtool/index.html">design of the Flashtool</a>. </p>
<h2 id="overview">Overview</h2>
<p>The next figure shows the structure of the <strong>Flashtool</strong>.</p>
<p><img alt="Flashtool_overview" src="../../../background/implementation/img/flashtool_overview.png" /></p>
<h2 id="configuration-file-and-working-directory">Configuration File And Working Directory</h2>
<p>The configuration file for the <strong>Flashtool</strong> is saved in a own working
directory for the <strong>Flashtool</strong>. This working directory can be set by the user
when the tool is initialized. When the user does not specify the working
directory it will be created in the <em>home</em> directory with the folder name
"<em>.flashtool</em>.</p>
<p>This working directory is used to save the configuration files for the
platforms and logging files of the <strong>Flashtool</strong>.</p>
<h2 id="recipe-file-for-platforms">Recipe File For Platforms</h2>
<p>The configuration file for the platform act as recipe for the setup procedure.
The user is able to define how to partition a <em>MMC</em> storage device of the
platform and where the products should be loaded. The <strong>Flashtool</strong> supports the
<em>MMC</em> storage device, because the platforms used in the HTWG context use
SD-cards as storage media. How to implement a new recipe type is explained in
the <a href="../../../setup/flashtool/deployment/add-new-deployment/index.html">deployment section</a> 
of the <strong>Flashtool</strong>.</p>
<h3 id="language">Language</h3>
<p>The language of the recipe file is <em>YAML</em>. A recipe file must contain at least
one <em>YAML document</em>. Each <em>YAML document</em> specifies a recipe. So a recipe file
contains one or more recipes. Each recipe must have a python counterpart, which
ensures if all required settings are given, checks the values of the
settings and implements the deployment procedure for the storage device.</p>
<pre><code>---
type : ${recipe type}

recipe:
    ${settings for recipe}
</code></pre>
<p>This example shows the basic structure of a recipe. Multiple recipes in a recipe
file must be divided by <code>---</code>.</p>
<h3 id="name-scheme">Name Scheme</h3>
<p>The name scheme of a recipe file is as follows:</p>
<p><code>{platform name}.yml}</code>
or
<code>{platform name}_{identifier}.yml</code></p>
<p>The <em>platform name</em> and the <em>identifier</em> must not contain underscores. The
platform name must also exist on the <em>buildserver configuration</em> for the specific
platform. With the <em>identifier</em> it is possible to set multiple recipe files for
a platform.</p>
<h3 id="availability-of-predefined-recipe-files">Availability of predefined recipe files</h3>
<p>The <strong>Flashtool</strong> retrieves its recipe files via a repository which is
configured on <a href="https://github.com/embEDUx/flashtool-recipes">github</a>. This
repository already contains recipe files for the rapsberry pi, beaglebone black,
utilite pro and banana pi, which are used in the HTWG context.
It is also possible to use an other repository with other recipe files.</p>
<p>The repository must be a git repository and the URL to it must be configured in the
<strong>Flashtool</strong> configuration.</p>
<h3 id="user-defined-recipe-files">User defined recipe files</h3>
<p>It is also possible for the user to add a directory for the <strong>Flashtool</strong> where
the user can add own recipe files. This directory is configured in the <strong>Flashtool</strong>
configuration file by the user.</p>
<h2 id="retrieving-software-products">Retrieving software products</h2>
<p>The built software product must be retrieved from the <strong>builbot</strong> web server.
The web server provides a <em>JSON api</em> to get all information about every built
which was made. This <em>JSON</em> information must be parsed by the <strong>Flashtool</strong> to get
all valid builds. The next list shows the paths which provide different
information about the <strong>buildbot master</strong> and which data is useful for the
<strong>Flashtool</strong>.</p>
<ul>
<li>
<p><code>/json</code></p>
<p>Get all supported platforms and which architecture the platform has. It also
gets the name of the builder for a specific architecture.</p>
<p><em>useful values</em> in json string ([i]: for each entry):</p>
<ul>
<li>builders[i]-&gt;basedir: builder name and architecture</li>
<li>builders[i]-&gt;schedulers: branch filter and platform name</li>
</ul>
</li>
<li>
<p><code>/json/builders/{builder name}/builds/-1</code></p>
<p>Get the last build of the builder.</p>
<p><em>useful values</em> in json string:</p>
<ul>
<li>number: build number</li>
</ul>
</li>
<li>
<p><code>/json/builders/{builder name}/builds/{build id}</code></p>
<p>Get information about a specific build. Check if build was successful and
save the following values for each successful build.</p>
<p><em>useful values</em> in json string:</p>
<ul>
<li>text: check for value <em>build</em> and <em>successful</em></li>
<li>properties-&gt;urls: path to the built files and product</li>
<li>properties-&gt;upload_files: Created files of the build</li>
</ul>
<p>With this information it is possible to create a download link for each
software product. The path is created by the following patterns:</p>
<pre><code>/{url}/{file name}
</code></pre>
</li>
</ul>
<p>The retrieved information of the web server tells the <strong>Flashtool</strong> which
product is available for which platform. The information for the architecture of
a platform is also provided in the JSON strings. This information is <strong>not</strong> stored
in the Flashtool and can only be retrieved from the <strong>buildserver</strong>.</p>
<h2 id="recognizing-mmc-devices">Recognizing <em>MMC</em> devices</h2>
<p>To recognize a plugged in <em>MMC</em> device the <strong>Flashtool</strong> uses the <em>pyudev</em> package. 
This package allows to listen to the <em>udev</em> events on the system and filter them by
some keywords. </p>
<p>First of all the user will be asked to remove the <em>MMC</em> media first. After
confirming this step, the python script listens for a <em>udev</em> event:</p>
<pre><code>context = Context()
monitor_mmc = Monitor.from_netlink(context)
monitor_mmc.filter_by(subsystem='block', device_type='disk')

for action, device in monitor_mmc:
    if action in ['add', 'change']:
        self.__count(action, device)
        break
</code></pre>
<p>The <em>udev</em> system will trigger various events when plugging in a <em>MMC</em> device.
Every event returns an <em>action</em> and a <em>device</em> name. The important event actions
are the <em>add</em> and <em>change</em> event. These events are counted for every device.</p>
<p>With this information, the <strong>Flashtool</strong> decides which of the recorded devices
were plugged in by the user. There are 4 scenarios how the user could plug in a
<em>MMC</em> card.</p>
<ol>
<li>
<p>User inserts <em>MMC</em> device into a external <em>MMC card reader</em> with multiple
    MMC slots:</p>
<p>Python dictionary looks like: (device <em>sdd</em> is <em>MMC</em> card)</p>
<pre><code>{'add': {}, 'change': {u'sdd': 2}}
</code></pre>
</li>
<li>
<p>User inserts the external <em>MMC card reader</em> in the <em>usb</em> port and then 
    inserts the <em>MMC</em> device into the card reader:</p>
<p>Python dictionary looks like: (device <em>sdd</em> is <em>MMC</em> card)</p>
<pre><code>{'add': {u'sdb': 1, u'sdc': 1, u'sdd': 1, u'sde': 1, u'sdf': 1},
 'change': {u'sdb': 1, u'sdc': 1, u'sdd': 5, u'sde': 1, u'sdf': 1}}
</code></pre>
</li>
<li>
<p>User inserts the external <em>MMC card reader</em> in the <em>usb</em> port and the
    <em>MMC</em> device was already plugged in the external <em>MMC card reader</em>:</p>
<p>Python dictionary looks like: (device <em>sdd</em> is <em>MMC</em> card)</p>
<pre><code>{'add': {u'sdb': 1, u'sdc': 1, u'sdd': 1, u'sde': 1, u'sdf': 1},
 'change': {u'sdb': 1, u'sdc': 1, u'sde': 1, u'sdf': 1}}
</code></pre>
<p>This scenario could also lead to a state, that the <strong>Flashtool</strong> would
recognize multiple <em>MMC</em> devices, if there were plugged in multiple <em>MMC</em>
devices in the external reader. If that happens the tool will ask the
user to choose one of the recognized devices.</p>
</li>
<li>
<p>User inserts <em>MMC</em> device into an internal <em>MMC card reader</em>:</p>
<p>Python dictionary looks like: (device <em>mmcblk0</em> is <em>MMC</em> card)</p>
<pre><code>{'add': {u'mmcblk0': 1}, 'change': {}}
</code></pre>
</li>
</ol>
<p>After recognizing the <em>MMC</em> device, the <strong>Flashtool</strong> will proceed with its
setup routine.</p>
<h2 id="deployment-of-products-to-the-mmc-device">Deployment Of Products To The <em>MMC</em> Device</h2>
<p>For the deployment procedure several steps has to be done. The sections below will
describe these steps:</p>
<h3 id="checking-first-mb-of-mmc-device">Checking First MB of <em>MMC</em> device</h3>
<p>Before partition the <em>MMC</em> device, the <strong>Flashtool</strong> generates one Megabyte of
random data and copies this data on the first Megabyte of the <em>MMC</em> device. 
After that the <strong>Flashtool</strong> reads this Megabyte from the <em>MMC</em> device. A <em>MD5</em>
hash will be generated for the read data and the generated data and will be
compared. When the hash strings are the same, the tool assumes that there is no
corrupted sector in the storage where the <em>MBR</em> or <em>GPT</em> is saved.</p>
<h3 id="partition-the-device">Partition The Device</h3>
<p>In the section <a href="../../evaluation/flashtool/index.html">evaluation</a> a decision was
made for the <em>pyparted</em> package for partitioning the <em>MMC</em> device. The Partition
layout will be given by the specified recipe file. The usage of the <em>MMC</em> recipe
is described in the <a href="../../../usage/flashtool/index.html">usage section of the flashtool</a>.</p>
<h3 id="format-the-partitions">Format The Partitions</h3>
<p>The <strong>Flashtool</strong> uses the <em>mkfs</em> tools of the system to format the partitions.
These command will be executed with the <a href="https://docs.python.org/3.4/library/subprocess.html">subprocess</a> 
package. </p>
<h3 id="load-the-products-on-the-mmc-device">Load The Products On The <em>MMC</em> Device</h3>
<p>The <strong>Flashtool</strong> retrieves all information about built products of the
<strong>buildbot</strong> server. The user can select which version of a product he wants to
load on the device. This can be done at the call of the <strong>Flashtool</strong> with the
options <code>linux, uboot, misc, rootfs</code> (see <a href="../../../usage/flashtool/index.html#deploy-products-on-the-platform">usage Chapter</a>).
If the string from the user matches for multiple files the specific file must be
selected during the deployment procedure.</p>
<p>Example:</p>
<pre><code class="bash">$ flashtool setup raspberry-pi

 +-----------------------------+
 | product:    rootfs          |
 | reg_name:                   |
 | file_types: rootfs, portage |
 +-----------------------------+
Found one version for product rootfs with regex .*.*
-&gt; Selected version: armv6j_hardfp_factory-systemd_20150306055251_c7ce255:

 +-------------------+
 | product:    uboot |
 | reg_name:         |
 | file_types: uboot |
 +-------------------+
Found multiple versions for product uboot with regex .*.*
  [0]: 2015.01-rc1_raspberry-pi_20150101144851_ef42c9b
  [1]: 2015.01_raspberry-pi_20150302180956_7021c3c

[MANUAL-MODE] Please select a file: [0-1]:
</code></pre>

<p>After selecting the product versions, the <em>MMC</em> device will be partition and the
partitions will be formated. Then the <strong>Flashtool</strong> will download the
product files with the python package <a href="https://docs.python.org/3.4/library/urllib.html">urllib</a>.</p>
<pre><code class="bash">   +-------------------+
   | LOAD FILES ON MMC |
   +-------------------+

GET BUILD FILES ROOTFS, LINUX, UBOOT, MISC FOR PLATFORM RASPBERRY-PI

  [rootfs]:
    DOWNLOAD FILE:
    URL:  http://moe.in.htwg-konstanz.de:8010/rootfs/factory-systemd/armv6j_hardfp_factory-systemd_20150306055251_c7ce255_rootfs.tbz2
    FILE: armv6j_hardfp_factory-systemd_20150306055251_c7ce255_rootfs.tbz2

     0.5% of 83.7818 MBytes

</code></pre>

<h2 id="generating-fstab">Generating <em>fstab</em></h2>
<p>At the end of the <strong>Flashtool</strong> it generates a <em>fstab</em> file and copies it to the
rootfs partition of the <em>MMC</em> device. The <em>fstab</em> will be generated with a
<a href="http://jinja.pocoo.org/">jinja2</a> template. The values for the template are
retrieved from the given recipe file and the information of pyudev. </p>
<p><strong>Example:</strong></p>
<p><em>Recipe file:</em></p>
<pre><code>---
type: mmc

recipe:
    partition_table: msdos
    partitions:
        -   name: boot
            size: 100mb
            fs_type: fat32
            mount_point: /boot
            mount_opts:
            flags: lba
        -   name: rootfs
            size: max
            fs_type: btrfs
            mount_point: /
            mount_opts:
            flags: 
...
</code></pre>

<p><em>jinja2 template:</em></p>
<pre><code># &lt;fs&gt;          &lt;mountpoint&gt;    &lt;type&gt;      &lt;opts&gt;      &lt;dump/pass&gt;
{% for obj in info %}
{{obj.uuid}}     {{obj.mountpoint}}     {{obj.type}}     {{obj.options}}     {{obj.dump}}     {{obj.pas}}
{% endfor %}
</code></pre>

<p><em>result fstab:</em></p>
<pre><code># &lt;fs&gt;          &lt;mountpoint&gt;    &lt;type&gt;      &lt;opts&gt;      &lt;dump/pass&gt;
UUID=cb7afe2c-d2de-4127-ba87-e8734f144b5f   /boot        vfat       defaults    0       0         
UUID=dc47945f-0282-4994-827e-fdc468bbc432   /        btrfs       defaults    0       0         
</code></pre>

<h2 id="list-of-features">List of features</h2>
<p>The table below shows a quick overview of the features of the <strong>Flashtool</strong>.
A detailed description of the command can be found in the <a href="../../../usage/flashtool/index.html">usage
section</a> of the <strong>Flashtool</strong></p>
<table>
<thead>
<tr>
<th>command</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>init / config</td>
<td>Configure needed options for the <strong>Flashtool</strong>. Must be done as first step (init) and can be changed any time (config)</td>
</tr>
<tr>
<td>platform_recipes</td>
<td>Get or update platform recipes from git repository</td>
</tr>
<tr>
<td>list_platforms</td>
<td>Shows which platforms have a recipe file and can be set up</td>
</tr>
<tr>
<td>list_builds</td>
<td>List all versions of software components on the platform, grouped by platform and product type</td>
</tr>
<tr>
<td>setup</td>
<td>runs a deployment procedure for the specified platform</td>
</tr>
<tr>
<td>check_mmc</td>
<td>Does a filesystem check on every partition on a mmc media</td>
</tr>
</tbody>
</table>
<h2 id="directory-structure-of-the-flashtool">Directory structure of the <strong>Flashtool</strong></h2>
<pre><code class="bash">flashtool
├── configmanager               # Handles the flashtool configuration file
│   └── __init__.py
│
├── server                      # Modules to connec to a Server
│   ├── buildserver.py          # Buildbot server, parsing json data, download files
│   ├── cfgserver.py            # Cloning and pulling from git server
│   └── __init__.py
│ 
├── setup                       # Setup related modules
│   ├── constants.py
│   ├── deploy                  # All packages for preparing hardware and loading software on device
│   │   ├── __init__.py
│   │   ├── load.py
│   │   ├── mmc.py
│   │   └── templateloader.py
│   ├── devlaout                # Contains all modules for setting up a layout for a storage device
│   │   ├── __init__.py
│   │   └── blockdev            # Functions for partition a blockdevice
│   ├── recipe                  # Python recipe representation, check keywords and values
│   │   ├── __init__.py
│   │   └── mmc.py
│   ├── setupfactory            # Loads the right modules statet in the recipe file
│   │   └── __init__.py
│   ├── udev                    # All udev related modules
│   │   ├── __init__.py
│   │   └── mmc.py              # Udev recognition of MMC devices
│   └── __init__.py
│
├── templates                   # Templates
│   └── fstab                   # fstab template
│
├── utility                     # Helper functions which are commonly used
│   └── __init__.py
│
├── tests                       # Directory for unit tests
│   ├── test_recipe.py
│   ├── test_recipe_load.py
│   ├── test_recipe_mmc.py
│   └── mock_path               # path mocks
│
└── __init__.py                 # Entry point of the Flashtool

</code></pre>

</div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/prettify-1.0.min.js"></script>
        <script src="../../../js/base.js"></script>
    </body>
</html>